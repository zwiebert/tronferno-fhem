<?xml version="1.0" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rev="made" href="mailto:root@localhost" />
</head>

<body>



<a name="Fernotron"></a>

<h3>Fernotron</h3>

<i>Fernotron</i> is a logic module to 1) control shutters using Fernotron protocol and 2) use Fernotron conrollers and sensors as general switches in FHEM.
 It sends/receives via the I/O device <i>SIGNALduino</i>. <i>Fernotron</i> can also receive messages sent by other Fernotron controllers. The Fernotron shutters communicate unidirectional, so they don't sent any feedback information, like if they are currently open or close.

<h4>Pairing</h4>

Each controller has an uniq ID number. To pair a shutter to one or more controller(s), the shutter just remembers the ID of each controller.

Each receiver can rmember one central controller unit (incl the group and member numbers), one sun sensor and some plain up/stop/down switches.

Shutter motors have also an ID number printed on.  If you have no easy access to the pyhsical Set-Button of the shutter motor, that ID can be used to initiate pairing/unpairing or adjust rotation direction and end-positions. 

<h4>Defining Devices</h4>

<h5>Output Devices</h5>

Each output device may control a single shutter, or a group of shutters depending on the parameters given in the define statement.

<p>
  <code>
    define <my_shutter> Fernotron a=ID [g=GN] [m=MN]<br>
  </code>			

<p> 
  ID : the device ID. A six digit hexadecimal number. 10xxxx=plain controller, 20xxxx=sun sensor, 80xxxx=central controller unit, 90xxxx=receiver<br>
  GN : group number (1-7) or 0 (default) for all groups<br>
  MN : member number  (1-7) or  0 (default) for all group members<br>

<p>
  'g' or  'n' are only useful combined with an ID of the central controller type. 

<h5>Input Devices</h5>

<p>  Incoming data is handled by input devices. There is one default input device, who handles all messages not matchin a defined input device. The default input device will be auto-created.

<p> Input devices are defined just like output devices, but with the parameter 'input' given in the define.

<p>
  <code>
    define <my_shutter> Fernotron a=ID [g=GN] [m=MN] input[=(plain|sun|central)]<br>
  </code>
<p>
The input type (like plain) can be ommitted. Its already determined by the ID (e.g. each ID starting with 10 is a plain controller).
<p>
  <code>
    define myFernoSwitch Fernotron a=10abcd input           # defines a plain controller as switch for up/down/stop<br>
    define myFernoSun Fernotron a=20abcd input              # defines a sun sensor as on/off switch (on: sunshine, off: no sunshine)<br>
    define myFernoSwitch2 Fernotron a=80abcd g=2 m=3 input  # defines a switch for up/down/stop controlled by a Fernotron central unit<br>
  </code>

<p> You can now  write the usual notify-devices or DOIF-devices to process events from your defined input devices

<p> Example: A Notify to toggle the lamp device  'HUEDevice3' if STOP was pressed your defined myFernoSwitch:
  <code>
    define n_toggleHUEDevice3 notify myFernoSwitch:stop set HUEDevice3 toggle
  </code>

<p> Its possible to use the default input device, if you don't want to define specific input devices:

<p> Example: Like above, but using the default (catch-all) input device scanFerno
  <code>
    define n_toggleHUEDevice3 notify scanFerno:plain:10abcd:stop set HUEDevice3 toggle
  </code>

<h4>Different Kinds of Adressing</h4>

<ol>
  <li> Scanning physical controllers and use their IDs.
    Example: Using the  ID of a  2411 controller to access shutters via group and member numbers.</li>

  <li> Making up IDs and pair them with shutters.
    Example: Pair shutter 1 with ID 100001, shutter  2 with 100002, ...</li>

<li> Receiver IDs: RF controlled shutters may have a 5 digit code printed on or on a small cable sticker.
  Prefix a 9 with it and you get an ID.</li>
</ol>

<h4>Making Groups</h4>

<ol>
  <li>groups and members are the same like in 2411. Groups are adressed using the 0 as wildcard.  (g=1 m=0 or g=0 m=1 or g=0 m=0) </li>

  <li> Like with plain controllers. Example: a (virtual) plain controller paired with each shutter of the entire floor.</li>

  <li> not possible with reeiver IDs</li>
</ol>


<h4>Commands</h4>

<ul>
  <li>up</li>
  <li>down</li>
  <li>stop</li>
  <li>set  - make receiver ready to pair</li>
  <li>sun-down - move down until sun position (but only, if sun automatic is enabled)</li>
  <li>sun-inst - set the current position as sun position</li>
</ul>

<h4>Examples</h4>
<ol>
  <li><ul>
      <li>first scan the ID of the 2411:  Hold down the stop button of your 2411 some time. Now open the automatically created default input device 'scanFerno', The ID can be found there under Internals:received_HR</li>
      <li><code>define rollo42 Fernotron a=80808 g=4 m=2</code></li>
  </ul></li>

  <li><ul>
      <li><code>define rollo1 Fernotron a=100001 </code></li>
      <li>enable set mode on the receiver</li>
      <li>press stop for rollo1</li>
  </ul></li>

  <li><ul>
      <li><code>define rollo_0d123 Fernotron a=90d123</code></li>
  </ul></li>
</ol>
=end html


</body>

</html>


